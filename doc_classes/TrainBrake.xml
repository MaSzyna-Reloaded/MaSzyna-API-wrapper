<?xml version="1.0" encoding="UTF-8" ?>
<class name="TrainBrake" inherits="TrainPart" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/godotengine/godot/master/doc/class.xsd">
	<brief_description>
		Represents and configures the vehicle brake system and exposes controls to operate it.
	</brief_description>
	<description>
		TrainBrake provides access to the underlying MaSzyna brake model for a vehicle. It lets you:
		- Configure key pneumatic parameters (pressures, tank volumes, cylinder geometry, friction method).
		- Select the brake distributor/valve type used by the vehicle.
		- Operate the main brake handle and auxiliary features like the brake releaser.
	</description>
	<tutorials>
	</tutorials>
	<methods>
		<method name="brake_level_decrease">
			<return type="void" />
			<description>
				Moves the main brake handle one step toward release (less braking). Clamped at the minimum position.
			</description>
		</method>
		<method name="brake_level_increase">
			<return type="void" />
			<description>
				Moves the main brake handle one step toward more braking. Clamped at the maximum position.
			</description>
		</method>
		<method name="brake_level_set">
			<return type="void" />
			<param index="0" name="level" type="float" />
			<description>
				Sets the normalized brake handle level in the range 0.0..1.0.
				0.0 maps to [constant BRAKE_HANDLE_POSITION_MIN], 1.0 maps to [constant BRAKE_HANDLE_POSITION_MAX].
				The mapping is linear between the device-specific minimum and maximum positions.
				See also [method brake_level_set_position].
			</description>
		</method>
		<method name="brake_level_set_position">
			<return type="void" />
			<param index="0" name="position" type="int" enum="TrainBrake.BrakeHandlePosition" />
			<description>
				Places the brake handle at a predefined position: MIN, MAX, DRIVE, FULL, or EMERGENCY.
			</description>
		</method>
		<method name="brake_level_set_position_str">
			<return type="void" />
			<param index="0" name="position" type="String" />
			<description>
				Set the brake handle by name. Accepted values (case-insensitive): "min", "max", "drive", "full", "emergency".
				This is a convenience wrapper around [method brake_level_set_position].
			</description>
		</method>
		<method name="brake_releaser">
			<return type="void" />
			<param index="0" name="enabled" type="bool" />
			<description>
				Operates the brake releaser (overrides to quickly release brake cylinder pressure).
				Pass true to engage the releaser, false to disengage. Typically used momentarily.
			</description>
		</method>
	</methods>
	<members>
		<member name="air_leak_multiplier" type="float" setter="set_air_leak_multiplier" getter="get_air_leak_multiplier" default="1.0">
			Air leak speed multiplier for brakes.
		</member>
		<member name="brake/method" type="int" setter="set_brake_method" getter="get_brake_method" enum="TrainBrake.BrakeMethod" default="0">
			Friction material used by the brake blocks or discs.
		</member>
		<member name="brake_force/max" type="float" setter="set_max_brake_force" getter="get_max_brake_force" default="1.0">
			Maximum train braking force in kN (used by the simplified brake model).
		</member>
		<member name="brake_force/traction" type="float" setter="set_traction_brake_force" getter="get_traction_brake_force" default="0.0">
			Magnetic track brake force in kN.
		</member>
		<member name="compressor/cab_a/max_pressure" type="float" setter="set_compressor_pressure_cab_a_max" getter="get_compressor_pressure_cab_a_max" default="0.0">
			Cab A compressor cut-out (maximum) pressure in bar.
			For engine-driven compressors, pressure cycles between this value and Cab A min pressure.
		</member>
		<member name="compressor/cab_a/min_pressure" type="float" setter="set_compressor_pressure_cab_a_min" getter="get_compressor_pressure_cab_a_min" default="0.0">
			Cab A compressor cut-in (minimum) pressure in bar.
			For engine-driven compressors, after reaching the cut-out pressure the system vents down to this value.
		</member>
		<member name="compressor/cab_b/max_pressure" type="float" setter="set_compressor_pressure_cab_b_max" getter="get_compressor_pressure_cab_b_max" default="0.0">
			Cab B compressor cut-out (maximum) pressure in bar.
			If set, Cab A values apply only when Cab A is active, and Cab B values apply when Cab B is active.
		</member>
		<member name="compressor/cab_b/min_pressure" type="float" setter="set_compressor_pressure_cab_b_min" getter="get_compressor_pressure_cab_b_min" default="0.0">
			Cab B compressor cut-in (minimum) pressure in bar.
			If set, Cab A values apply only when Cab A is active, and Cab B values apply when Cab B is active.
		</member>
		<member name="compressor/higher_emergency_closing_pressure" type="float" setter="set_higher_emergency_closing_pressure" getter="get_higher_emergency_closing_pressure" default="-1.0">
			Main tank safety valve unlocking pressure
		</member>
		<member name="compressor/lower_emergency_closing_pressure" type="float" setter="set_lower_emergency_closing_pressure" getter="get_lower_emergency_closing_pressure" default="-1.0">
			Main tank safety valve opening pressure
		</member>
		<member name="compressor/power" type="int" setter="set_compressor_power" getter="get_compressor_power" enum="TrainBrake.CompressorPower" default="0">
			Compressor power source.
		</member>
		<member name="compressor/speed" type="float" setter="set_compressor_speed" getter="get_compressor_speed" default="0.0">
			Compressor flow rate in m³/s.
		</member>
		<member name="compressor/tank_valve_active" type="bool" setter="set_compressor_tank_valve_active" getter="get_compressor_tank_valve_active" default="false">
			Behavior upon overpressure in the main tank when the compressor is driven by an internal combustion engine:
			false - the compressor pumps to the atmosphere, the tank slowly empties itself, after reaching [member compressor_pressure_cab_a_min], the compressor pumps to the tank
			true - the compressor fully fills the tank, the valve releases pressure from the tank upon reaching [member compressor_pressure_cab_a_max]
		</member>
		<member name="cylinder/count" type="int" setter="set_cylinder_count" getter="get_cylinder_count" default="0">
			Number of brake cylinders
		</member>
		<member name="cylinder/distance" type="float" setter="set_cylinder_distance" getter="get_cylinder_distance" default="0.0">
			Brake cylinder piston travel during braking in meters.
		</member>
		<member name="cylinder/gear_ratio" type="float" setter="set_cylinder_gear_ratio" getter="get_cylinder_gear_ratio" default="0.0">
			Mechanical advantage from cylinder force to total brake force on all serviced wheels (dimensionless).
			Use this when the ratio is constant; otherwise use the low/high variants below.
		</member>
		<member name="cylinder/gear_ratio_high" type="float" setter="set_cylinder_gear_ratio_high" getter="get_cylinder_gear_ratio_high" default="0.0">
			Mechanical ratio for the loaded/high setting (dimensionless).
		</member>
		<member name="cylinder/gear_ratio_low" type="float" setter="set_cylinder_gear_ratio_low" getter="get_cylinder_gear_ratio_low" default="0.0">
			Mechanical ratio for the empty/low setting (dimensionless).
		</member>
		<member name="cylinder/radius" type="float" setter="set_cylinder_radius" getter="get_cylinder_radius" default="0.0">
			Brake cylinder radius in meters.
		</member>
		<member name="cylinder/spring_force" type="float" setter="set_cylinder_spring_force" getter="get_cylinder_spring_force" default="0.0">
			Return spring force per cylinder in kN.
		</member>
		<member name="est_valve/size" type="int" setter="set_est_valve_size" getter="get_est_valve_size" default="0">
			Size index of the ESt family camshaft valve (e.g., 1–3). Used only with ESt/LSt-type valves.
		</member>
		<member name="friction_elements_per_axle" type="int" setter="set_friction_elements_per_axle" getter="get_friction_elements_per_axle" default="1">
			Number of friction elements per axle (0–4).
		</member>
		<member name="main_pipe/blocking_pressure" type="float" setter="set_main_pipe_blocking_pressure" getter="get_main_pipe_blocking_pressure" default="0.0">
			Main line blocking pressure
		</member>
		<member name="main_pipe/minimum_unblocking_handle_position" type="int" setter="set_main_pipe_minimum_unblocking_handle_position" getter="get_main_pipe_minimum_unblocking_handle_position" default="-3">
			Minimum brake handle position in order to unblock the main pipe
		</member>
		<member name="main_pipe/unblocking_pressure" type="float" setter="set_main_pipe_unblocking_pressure" getter="get_main_pipe_unblocking_pressure" default="0.0">
			Main line unblocking pressure
		</member>
		<member name="max_antislip_pressure" type="float" setter="set_max_antislip_pressure" getter="get_max_antislip_pressure" default="0.0">
			Maximum anti-slip brake cylinder pressure in bar. Set to 0 to disable the limit.
		</member>
		<member name="max_aux_pressure" type="float" setter="set_max_aux_pressure" getter="get_max_aux_pressure" default="0.0">
			Maximum auxiliary (empty) brake cylinder pressure in bar. If 0, defaults to [member max_cylinder_pressure].
		</member>
		<member name="max_cylinder_pressure" type="float" setter="set_max_cylinder_pressure" getter="get_max_cylinder_pressure" default="0.0">
			Maximum service brake cylinder pressure in bar. When &gt; 0, detailed cylinder parameters are applied.
		</member>
		<member name="max_medium_pressure" type="float" setter="set_max_medium_pressure" getter="get_max_medium_pressure" default="0.0">
			Maximum brake cylinder pressure at a medium load in bar.
		</member>
		<member name="max_tare_pressure" type="float" setter="set_max_tare_pressure" getter="get_max_tare_pressure" default="0.0">
			Maximum brake cylinder pressure at tare (an empty) load in bar.
		</member>
		<member name="pipe/pressure_max" type="float" setter="set_pipe_pressure_max" getter="get_pipe_pressure_max" default="5.0">
			Nominal high (charged) main pipe pressure in bar.
		</member>
		<member name="pipe/pressure_min" type="float" setter="set_pipe_pressure_min" getter="get_pipe_pressure_min" default="3.5">
			Nominal low (reduced) main pipe pressure in bar.
		</member>
		<member name="piston_stroke/adjuster_resistance" type="float" setter="set_piston_stroke_adjuster_resistance" getter="get_piston_stroke_adjuster_resistance" default="0.0">
			Slack adjuster resistance force in kN.
		</member>
		<member name="rapid/switching_speed" type="float" setter="set_rapid_switching_speed" getter="get_rapid_switching_speed" default="55.0">
			Vehicle speed in km/h at which the Rapid (R) characteristic engages.
		</member>
		<member name="rapid/transfer" type="float" setter="set_rapid_transfer" getter="get_rapid_transfer" default="1.0">
			High-to-low pressure ratio of braking in Rapid mode (dimensionless multiplier).
		</member>
		<member name="rig_effectiveness" type="float" setter="set_rig_effectiveness" getter="get_rig_effectiveness" default="0.0">
			Brake rigging efficiency coefficient (0..1).
		</member>
		<member name="tank/volume_aux" type="float" setter="set_aux_tank_volume" getter="get_aux_tank_volume" default="0.0">
			Auxiliary reservoir volume in liters (l).
		</member>
		<member name="tank/volume_main" type="float" setter="set_main_tank_volume" getter="get_main_tank_volume" default="0.0">
			Main reservoir volume in cubic meters (m³).
		</member>
		<member name="valve/type" type="int" setter="set_valve_type" getter="get_valve_type" enum="TrainBrake.TrainBrakeValve" default="0">
			Brake distributor/valve type.
		</member>
	</members>
	<constants>
		<constant name="COMPRESSOR_POWER_MAIN" value="0" enum="CompressorPower">
			Supplied directly from the vehicle's high-voltage traction circuit ("mains"). Available whenever the HV circuit is live (for example, pantograph up and main contactors closed). Does not require the auxiliary converter.
		</constant>
		<constant name="COMPRESSOR_POWER_UNUSED" value="1" enum="CompressorPower">
			Reserved/unused. Kept for backward compatibility; do not use in new content.
		</constant>
		<constant name="COMPRESSOR_POWER_CONVERTER" value="2" enum="CompressorPower">
			Powered from the low-voltage auxiliary converter. The compressor becomes available automatically after the converter is switched on and stops when the converter is off.
		</constant>
		<constant name="COMPRESSOR_POWER_ENGINE" value="3" enum="CompressorPower">
			Coupled with a diesel engine. Starts automatically with the engine, and the delivery depends on engine RPM. When pressure exceeds the governor threshold, excess air is vented instead of stopping the compressor.
		</constant>
		<constant name="COMPRESSOR_POWER_COUPLER1" value="4" enum="CompressorPower">
			Powered via the train's low-voltage train line supplied by another vehicle through coupler side 1 (front). Requires the remote vehicle's converter to be on.
		</constant>
		<constant name="COMPRESSOR_POWER_COUPLER2" value="5" enum="CompressorPower">
			Powered via the train's low-voltage train line supplied by another vehicle through coupler side 2 (rear). Requires the remote vehicle's converter to be on.
		</constant>
		<constant name="BRAKE_HANDLE_POSITION_MIN" value="0" enum="BrakeHandlePosition">
			Minimal brake position
		</constant>
		<constant name="BRAKE_HANDLE_POSITION_MAX" value="1" enum="BrakeHandlePosition">
			Maximal brake position
		</constant>
		<constant name="BRAKE_HANDLE_POSITION_DRIVE" value="2" enum="BrakeHandlePosition">
			Drive brake position
		</constant>
		<constant name="BRAKE_HANDLE_POSITION_FULL" value="3" enum="BrakeHandlePosition">
			Full brake position
		</constant>
		<constant name="BRAKE_HANDLE_POSITION_EMERGENCY" value="4" enum="BrakeHandlePosition">
			Emergency brake position
		</constant>
		<constant name="BRAKE_VALVE_NO_VALVE" value="0" enum="TrainBrakeValve">
			No brake valve
		</constant>
		<constant name="BRAKE_VALVE_W" value="1" enum="TrainBrakeValve">
			Westinghouse W distributor (classic triple valve).
		</constant>
		<constant name="BRAKE_VALVE_W_LU_VI" value="2" enum="TrainBrakeValve">
			Westinghouse W with LU (load-compensating) module, variant VI.
		</constant>
		<constant name="BRAKE_VALVE_W_LU_L" value="3" enum="TrainBrakeValve">
			Westinghouse W with LU (load-compensating) module, variant L.
		</constant>
		<constant name="BRAKE_VALVE_W_LU_XR" value="4" enum="TrainBrakeValve">
			Westinghouse W with LU (load-compensating) module, variant XR.
		</constant>
		<constant name="BRAKE_VALVE_K" value="5" enum="TrainBrakeValve">
			Knorr K distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_KG" value="6" enum="TrainBrakeValve">
			Knorr KG distributor valve (load-compensated variant).
		</constant>
		<constant name="BRAKE_VALVE_KP" value="7" enum="TrainBrakeValve">
			Knorr KP distributor valve (passenger variant with quick service).
		</constant>
		<constant name="BRAKE_VALVE_KSS" value="8" enum="TrainBrakeValve">
			Knorr Kss distributor valve (freight, two-step characteristics).
		</constant>
		<constant name="BRAKE_VALVE_KKG" value="9" enum="TrainBrakeValve">
			Knorr KKg distributor valve (combined passenger/freight characteristics).
		</constant>
		<constant name="BRAKE_VALVE_KKP" value="10" enum="TrainBrakeValve">
			Knorr KKp distributor valve (passenger/freight variant).
		</constant>
		<constant name="BRAKE_VALVE_KKS" value="11" enum="TrainBrakeValve">
			Knorr Kks distributor valve (freight variant).
		</constant>
		<constant name="BRAKE_VALVE_HIKG1" value="12" enum="TrainBrakeValve">
			Hildebrand-Knorr HiK-G1 distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_HIKSS" value="13" enum="TrainBrakeValve">
			Hildebrand-Knorr HiK-ss distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_HIKP1" value="14" enum="TrainBrakeValve">
			Hildebrand-Knorr HiK-P1 distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_KE" value="15" enum="TrainBrakeValve">
			Knorr KE distributor valve (widely used on passenger stock).
		</constant>
		<constant name="BRAKE_VALVE_SW" value="16" enum="TrainBrakeValve">
			SW-series distributor valve (e.g. Oerlikon / SAB WABCO family).
		</constant>
		<constant name="BRAKE_VALVE_ESTED" value="17" enum="TrainBrakeValve">
			ESt-ED camshaft distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_NEST3" value="18" enum="TrainBrakeValve">
			NESt-3 distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_EST3" value="19" enum="TrainBrakeValve">
			ESt-3 camshaft distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_LST" value="20" enum="TrainBrakeValve">
			LSt camshaft distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_EST4" value="21" enum="TrainBrakeValve">
			ESt-4 camshaft distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_EST3AL2" value="22" enum="TrainBrakeValve">
			ESt-3 AL2 camshaft distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_EP1" value="23" enum="TrainBrakeValve">
			EP-1 electropneumatic distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_EP2" value="24" enum="TrainBrakeValve">
			EP-2 electropneumatic distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_M483" value="25" enum="TrainBrakeValve">
			M-483 distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_CV1_L_TR" value="26" enum="TrainBrakeValve">
			DAKO CV1 distributor valve (left/transit variant).
		</constant>
		<constant name="BRAKE_VALVE_CV1" value="27" enum="TrainBrakeValve">
			DAKO CV1 distributor valve.
		</constant>
		<constant name="BRAKE_VALVE_CV1_R" value="28" enum="TrainBrakeValve">
			DAKO CV1 distributor valve (right-hand variant).
		</constant>
		<constant name="BRAKE_VALVE_OTHER" value="29" enum="TrainBrakeValve">
			Other/unknown distributor valve type.
		</constant>
		<constant name="BRAKE_METHOD_P10Bgu" value="0" enum="BrakeMethod">
			Cast-iron tread brake blocks P10 (variant Bgu). Legacy phosphorus cast‑iron shoes used on block brakes; robust but noisy and abrasive. Use for older stock with P10 blocks.
		</constant>
		<constant name="BRAKE_METHOD_P10Bg" value="1" enum="BrakeMethod">
			Cast-iron tread brake blocks P10 (variant Bg). Similar to Bgu with a slightly different friction curve; traditional iron shoes for block brakes.
		</constant>
		<constant name="BRAKE_METHOD_D1" value="2" enum="BrakeMethod">
			Disc brake, pad type D1. Standard railway disc brake friction law; select when the vehicle is equipped with disc brakes.
		</constant>
		<constant name="BRAKE_METHOD_D2" value="3" enum="BrakeMethod">
			Disc brake, pad type D2. Alternative compound/geometry with a different μ(v) characteristic (typically higher friction at speed) for disc brakes.
		</constant>
		<constant name="BRAKE_METHOD_FR513" value="4" enum="BrakeMethod">
			Composite tread brake blocks Frenoplast FR‑513 (K‑block). Quieter and less wheel‑abrasive than cast iron; common on modernized wagons.
		</constant>
		<constant name="BRAKE_METHOD_Cosid" value="5" enum="BrakeMethod">
			Composite tread brake blocks (e.g., Cosid K‑block family). Use as a generic composite block when a more specific type is unknown.
		</constant>
		<constant name="BRAKE_METHOD_P10yBg" value="6" enum="BrakeMethod">
			Cast-iron tread brake blocks P10 (variant yBg). P10 iron shoes with a modified characteristic ("y" curve) used in some braking tables.
		</constant>
		<constant name="BRAKE_METHOD_P10yBgu" value="7" enum="BrakeMethod">
			Cast-iron tread brake blocks P10 (variant yBgu). As above with the "y" curve applied to the Bgu variant.
		</constant>
		<constant name="BRAKE_METHOD_D1MG" value="9" enum="BrakeMethod">
			Disc brake (D1 pads) plus magnetic track brake. Use when the vehicle has magnetic rail brakes; pneumatic braking follows D1 while magnetic force adds at higher speeds.
		</constant>
	</constants>
</class>
